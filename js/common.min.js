window.onload = function () {

    const
        body = $("body"),
        hidden = "hidden",
        active = "active";


     function changeRegisterMethod(btn, fild){
        btn.on("click", function(){
            $(".bl_form__text").removeClass(active);
            $(this).addClass(active);
            $(".bl_form__label").addClass(hidden);
            fild.removeClass(hidden);
        });
     }
    changeRegisterMethod($(".btn_email"), $(".label_email"));
    changeRegisterMethod($(".btn_tel"), $(".label_phone"));


    /////////// ANIMATION

    const results = {
        machine1: document.querySelector('#machine1Result'),
        machine2: document.querySelector('#machine2Result'),
        machine3: document.querySelector('#machine3Result')
    };
    const el1 = document.querySelector('#machine1');
    const el2 = document.querySelector('#machine2');
    const el3 = document.querySelector('#machine3');

    let finishedNumber = 2;

    const machine1 = new SlotMachine(el1, {
        active: 1,  //////// Какой элемент виден изначально
        spins: 4,
        delay: 500,
        randomize() {
            return finishedNumber;
        }
    });
    const machine2 = new SlotMachine(el2, {
        active: 4,  //////// Какой элемент виден изначально
        spins: 4,
        delay: 500,
        randomize() {
            return finishedNumber;
        }
    });

    const machine3 = new SlotMachine(el3, {
        active: 3,  //////// Какой элемент виден изначально
        spins: 4,
        delay: 500,
        randomize() {
            return finishedNumber;
        }
    });

    const btnStart = $(".js-start");



    btnStart.one("click", function () {

        // console.log("Ok");


        const mainPhrase = $(".js-mainPhrase"),
            btn_bonus = $(".btn_bonus"),

            timeStep1 = 4000,
            timeStep2 = timeStep1 + 1000,
            timeStep2_1 = timeStep2 - 1000,
            timeStep3 = timeStep2 + 4000;


        /////////////

        /////// Юзер попадает на лендинг и нажимает на кнопку "Старт"
        /////////Слот крутиться, выпадает первая линия("777"). Иконка с бонусом 225 фриспинов меняет цвет(с серого на фиолетовый(на макете видно))


        function stepOne() {
            machine1.shuffle(5);
            machine2.shuffle(6);
            machine3.shuffle(8);

            setTimeout(function () {
                btn_bonus.eq(0).addClass(active);
                mainPhrase.addClass(hidden);
                mainPhrase.eq(1).removeClass(hidden);

            }, timeStep1);
        }

        stepOne();


        //////// СРАЗУ!!! слот начинает крутиться опять и выпадает вторая линия("3 короля"). Иконка с бонусом 150% на 1-й депозит меняет цвет.
        function stepTwo() {

            setTimeout(function () {
                finishedNumber = 0;
                machine1.shuffle(5);
                machine2.shuffle(6);
                machine3.shuffle(5);

                setTimeout(function () {
                    btn_bonus.eq(1).addClass(active);
                    mainPhrase.addClass(hidden);
                    mainPhrase.eq(2).removeClass(hidden);
                }, timeStep2_1);

            }, timeStep2);


        }

        stepTwo();


        // //////////СРАЗУ!!! открывается форма регистрации. Форма регистрация имеет 1 поле для ввода email.


        function stepThree() {

            setTimeout(function () {

                $(".coverLayer").removeClass(hidden).addClass("coverLayer_animation"); /// 200ms
                $(".bl_popup").removeClass(hidden); /// 500ms + d200ms

                // $(".bl_form__input").focus();


            }, timeStep3);
        }

        stepThree();


        ///////////////////////

    });


////////////////

};


